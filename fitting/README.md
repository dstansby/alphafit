This folder contains the code that generates the alphafit dataset from the
original distribution function files.

The following steps can be used to download the code, original data files, and
required dependencies.

Downloading and installing software
-----------------------------------
1. Download a copy of this repository
2. Install [conda](https://conda.io/docs/user-guide/install/index.html)
3. Create a new environment from the provided environment file:
```bash
conda env create -f environment.yml
```

Configuring data output
-----------------------
In the `alphafit` directory, change the name of
`config.ini.template` to `config.ini` and fill in the directory where you
would like the output data to be saved to

Downloading original data files
-------------------------------
1. Create a directory to store all of the original magnetic field and
distribution function data files.
2. Configure heliopy to look in this location for the data files. Create
a heliopyrc file using
```bash
mkdir ~/.heliopy
echo "download_dir = /data/storage/directory" >> ~/.heliopy/heliopyrc
```
(replacing "/data/storage/directory" by the directory where all the data will
be stored)

3. Download the original distribution function files from ftp://apollo.ssl.berkeley.edu/pub/helios-data/E1_experiment/helios_original/

The directory structure in your download location needs changing a bit,
and should look like (1974 is an example year, 44 is an example day of year)
```bash
/data/storage/directory/helios/helios1/dist/1974/44/...
```
If you only want to regenerate specific days of data, you only need to download
the relevant files and not the entire dataset.

Regenerating the alphafit dataset
--------------------------------
The alphafit data set can now be re-generated by changing to the
`alphafit` directory and running

```bash
python fitting/save_alpha_params.py
```

This will generate the data set in *.csv* files.
